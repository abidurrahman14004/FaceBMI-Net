<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BMI Predictor - AI-Powered Body Mass Index Calculator</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="bg-gradient-primary">
    <div class="container-fluid p-0">
        <div class="row g-0 min-vh-100">
            <!-- Left Sidebar Navigation -->
            <aside class="col-lg-3 col-xl-2 sidebar-custom">
                <div class="sidebar-content p-4 h-100 d-flex flex-column">
                    <div class="sidebar-header mb-4 pb-3 border-bottom border-light border-opacity-25">
                        <h1 class="h3 mb-2 text-white fw-bold">
                            <i class="bi bi-robot"></i> BMI Predictor
                        </h1>
                        <p class="text-white-50 small mb-0">AI-Powered Analysis</p>
                    </div>
                    
                    <nav class="sidebar-nav flex-grow-1">
                        <ul class="nav flex-column gap-2">
                            <li class="nav-item">
                                <a href="#introduction" class="nav-link-custom active" data-section="introduction">
                                    <i class="bi bi-book me-2"></i>
                                    <span>Introduction</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="#how-it-works" class="nav-link-custom" data-section="how-it-works">
                                    <i class="bi bi-gear me-2"></i>
                                    <span>How It Works</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="#the-app" class="nav-link-custom" data-section="the-app">
                                    <i class="bi bi-app me-2"></i>
                                    <span>The App</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="/samples" class="nav-link-custom">
                                    <i class="bi bi-images me-2"></i>
                                    <span>Samples</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="/privacy-policy" class="nav-link-custom">
                                    <i class="bi bi-shield-lock me-2"></i>
                                    <span>Privacy Policy</span>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </aside>

            <!-- Main Content Area -->
            <main class="col-lg-9 col-xl-10 main-content-custom">
                <div class="p-4 p-md-5">
                    <!-- Introduction Section -->
                    <section id="introduction" class="content-section active">
                        <div class="mb-4">
                            <h2 class="text-white fw-bold mb-3">Introduction</h2>
                        </div>
                        <div class="card shadow-lg border-0">
                            <div class="card-body p-4 p-md-5">
                                <h3 class="card-title mb-4 fw-bold">Welcome to BMI Predictor</h3>
                                <p class="card-text lead mb-4">
                                    Our AI-powered BMI (Body Mass Index) Predictor uses advanced machine learning to estimate your BMI from a single photograph. This innovative tool combines computer vision, deep learning, and multi-modal data analysis to provide accurate predictions.
                                </p>
                                
                                <div class="alert alert-info border-0 shadow-sm mt-4 mb-4" role="alert">
                                    <div class="text-center">
                                        <p class="mb-0" style="color: #667eea; font-weight: bold; font-size: 1.1rem;">
                                            <i class="bi bi-university me-2"></i>
                                            Developed by the Qatar University research team, led by Dr. Amith Khandakar
                                        </p>
                                    </div>
                                </div>
                                
                                <h4 class="mt-5 mb-3 fw-bold">What is BMI?</h4>
                                <p class="card-text mb-4">
                                    Body Mass Index (BMI) is a measure of body fat based on height and weight. It's calculated by dividing your weight in kilograms by the square of your height in meters. BMI categories include:
                                </p>
                                <ul class="list-unstyled mb-4">
                                    <li class="mb-2"><i class="bi bi-circle-fill text-primary me-2" style="font-size: 0.5rem;"></i><strong>Underweight:</strong> BMI less than 18.5</li>
                                    <li class="mb-2"><i class="bi bi-circle-fill text-success me-2" style="font-size: 0.5rem;"></i><strong>Normal weight:</strong> BMI 18.5 to 24.9</li>
                                    <li class="mb-2"><i class="bi bi-circle-fill text-warning me-2" style="font-size: 0.5rem;"></i><strong>Overweight:</strong> BMI 25 to 29.9</li>
                                    <li class="mb-2"><i class="bi bi-circle-fill text-danger me-2" style="font-size: 0.5rem;"></i><strong>Obese:</strong> BMI 30 or higher</li>
                                </ul>
                                
                                <div class="alert alert-warning border-0 shadow-sm mt-4" role="alert">
                                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                                    <strong>Important Note:</strong> This tool is for demonstration purposes only. For accurate health assessments, please consult with a healthcare professional. BMI is a screening tool and may not accurately reflect body fat percentage for all individuals.
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- How It Works Section -->
                    <section id="how-it-works" class="content-section d-none">
                        <div class="mb-4">
                            <h2 class="text-white fw-bold mb-3">How the Model Works</h2>
                        </div>
                        <div class="card shadow-lg border-0">
                            <div class="card-body p-4 p-md-5">
                                <h3 class="card-title mb-4 fw-bold">Hybrid Deep Learning Architecture</h3>
                                <p class="card-text mb-4">
                                    Our model uses a sophisticated hybrid architecture that combines multiple data modalities:
                                </p>
                                
                                <div class="row g-4 mb-4">
                                    <div class="col-md-6">
                                        <div class="feature-card h-100 p-4 rounded-3 shadow-sm">
                                            <div class="feature-icon mb-3">
                                                <i class="bi bi-image text-primary" style="font-size: 2.5rem;"></i>
                                            </div>
                                            <h5 class="fw-bold mb-3">Image Processing</h5>
                                            <p class="text-muted mb-0">
                                                Uses ResNet18 convolutional neural network to extract visual features from facial images, analyzing facial structure and body proportions.
                                            </p>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="feature-card h-100 p-4 rounded-3 shadow-sm">
                                            <div class="feature-icon mb-3">
                                                <i class="bi bi-bar-chart text-info" style="font-size: 2.5rem;"></i>
                                            </div>
                                            <h5 class="fw-bold mb-3">Tabular Features</h5>
                                            <p class="text-muted mb-0">
                                                Processes 36 engineered features including facial measurements, ratios, and demographic information through a multi-layer neural network.
                                            </p>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="feature-card h-100 p-4 rounded-3 shadow-sm">
                                            <div class="feature-icon mb-3">
                                                <i class="bi bi-diagram-3 text-success" style="font-size: 2.5rem;"></i>
                                            </div>
                                            <h5 class="fw-bold mb-3">Graph Neural Network</h5>
                                            <p class="text-muted mb-0">
                                                Analyzes 21 facial landmarks using a multi-scale Graph Convolutional Network (GCN) to understand spatial relationships between facial features.
                                            </p>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="feature-card h-100 p-4 rounded-3 shadow-sm">
                                            <div class="feature-icon mb-3">
                                                <i class="bi bi-arrow-left-right text-warning" style="font-size: 2.5rem;"></i>
                                            </div>
                                            <h5 class="fw-bold mb-3">Fusion & Prediction</h5>
                                            <p class="text-muted mb-0">
                                                Combines all features using multi-head attention mechanism and shared layers to generate accurate BMI predictions.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                
                                <h4 class="mt-5 mb-3 fw-bold">Model Training</h4>
                                <p class="card-text mb-0">
                                    The model was trained using 5-fold cross-validation on a comprehensive dataset, ensuring robust performance and generalization. It uses multi-task learning to simultaneously predict BMI, age, sex, and BMI category.
                                </p>
                            </div>
                        </div>
                    </section>

                    <!-- The App Section -->
                    <section id="the-app" class="content-section d-none">
                        <div class="mb-4">
                            <h2 class="text-white fw-bold mb-3">The App</h2>
                        </div>
                        <div class="row g-4">
                            <!-- Left: Image Upload -->
                            <div class="col-lg-6">
                                <div class="card shadow-lg border-0 h-100">
                                    <div class="card-header bg-white border-0 pb-3">
                                        <h3 class="card-title mb-0 fw-bold">
                                            <i class="bi bi-upload me-2 text-primary"></i>Upload Your Image
                                        </h3>
                                    </div>
                                    <div class="card-body p-4">
                                        <div class="upload-section">
                                            <div class="upload-box-custom" id="uploadBox">
                                                <div class="upload-content text-center py-5">
                                                    <i class="bi bi-cloud-upload text-primary mb-3" style="font-size: 4rem;"></i>
                                                    <h5 class="fw-bold mb-2">Drag & Drop your image here</h5>
                                                    <p class="text-muted mb-3">or click to browse</p>
                                                    <input type="file" id="imageInput" accept="image/*" hidden>
                                                    <button type="button" class="btn btn-primary btn-lg rounded-pill px-4 browse-btn">
                                                        <i class="bi bi-folder2-open me-2"></i>Browse Files
                                                    </button>
                                                </div>
                                            </div>

                                            <div class="preview-section" id="previewSection" style="display: none;">
                                                <div class="image-preview-wrapper mb-4">
                                                    <div class="position-relative d-inline-block">
                                                        <img id="previewImage" src="" alt="Preview" class="img-fluid rounded-3 shadow">
                                                        <button class="btn btn-danger btn-sm rounded-circle position-absolute top-0 end-0 m-2" onclick="removeImage()" style="width: 35px; height: 35px;">
                                                            <i class="bi bi-x-lg"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                                <button class="btn btn-primary btn-lg w-100 rounded-pill" id="predictBtn" onclick="predictBMI()">
                                                    <span id="predictBtnText">
                                                        <i class="bi bi-calculator me-2"></i>Predict BMI
                                                    </span>
                                                    <span id="predictBtnLoader" class="spinner-border spinner-border-sm" role="status" aria-hidden="true" style="display: none;"></span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Right: Results -->
                            <div class="col-lg-6">
                                <div class="card shadow-lg border-0 h-100">
                                    <div class="card-header bg-white border-0 pb-3">
                                        <h3 class="card-title mb-0 fw-bold">
                                            <i class="bi bi-graph-up-arrow me-2 text-success"></i>Your Results
                                        </h3>
                                    </div>
                                    <div class="card-body p-4">
                                        <div class="result-section" id="resultSection">
                                            <div class="result-placeholder text-center py-5">
                                                <i class="bi bi-graph-up text-muted mb-3" style="font-size: 4rem; opacity: 0.3;"></i>
                                                <p class="text-muted">Upload an image and click "Predict BMI" to see your results here</p>
                                            </div>
                                        </div>
                                        
                                        <div class="result-card" id="resultCard" style="display: none;">
                                            <div class="bmi-display text-center mb-4">
                                                <div class="bmi-value mb-2" id="bmiValue">--</div>
                                                <div class="bmi-category h4 mb-4" id="bmiCategory">--</div>
                                            </div>
                                            <div class="bmi-message alert alert-info border-0 shadow-sm mb-4" id="bmiMessage" role="alert"></div>
                                            <div class="bmi-scale position-relative mb-4">
                                                <div class="scale-bar d-flex rounded overflow-hidden shadow-sm">
                                                    <div class="scale-segment underweight flex-fill d-flex align-items-center justify-content-center text-white fw-bold py-3">
                                                        <small>Underweight</small>
                                                    </div>
                                                    <div class="scale-segment normal flex-fill d-flex align-items-center justify-content-center text-white fw-bold py-3">
                                                        <small>Normal</small>
                                                    </div>
                                                    <div class="scale-segment overweight flex-fill d-flex align-items-center justify-content-center text-white fw-bold py-3">
                                                        <small>Overweight</small>
                                                    </div>
                                                    <div class="scale-segment obese flex-fill d-flex align-items-center justify-content-center text-white fw-bold py-3">
                                                        <small>Obese</small>
                                                    </div>
                                                </div>
                                                <div class="scale-indicator" id="scaleIndicator"></div>
                                            </div>
                                            <button class="btn btn-secondary w-100 rounded-pill" onclick="resetApp()">
                                                <i class="bi bi-arrow-clockwise me-2"></i>Upload Another Image
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </main>
        </div>
    </div>

    <!-- Error Toast -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="errorToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header bg-danger text-white">
                <i class="bi bi-exclamation-triangle-fill me-2"></i>
                <strong class="me-auto">Error</strong>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" id="errorMessage"></div>
        </div>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
